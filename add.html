<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    <title>Inventory of federal crowdsourcing and citizen science projects, by Commons Lab - Wilson Center</title>

    <link rel="stylesheet" href="css/bootstrap.min.css" />
    <link rel="stylesheet" href="css/datepicker.css" />
    <link rel="stylesheet" href="css/cartodb.css" />
    <link rel="stylesheet" href="css/leaflet-0.7.3.css" />
    <link rel="stylesheet" href="css/leaflet.draw.css" />
    <link rel="stylesheet" href="css/font-awesome.min.css" />
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800">
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->
    <link rel="stylesheet" href="css/style.css" />

  </head>
  <body class="container-fluid">

    <header>
      <nav class="row">
        <div class="col-md-6">
          <image xlink:href="img/commons_logo.svg" src="img/commons_logo.png"
                 width="260" height="40" />
          <!-- <image xlink:href="img/wilson_logo.svg" src="img/wilson_logo.png" -->
          <!--        width="260" height="40" /> -->
        </div>
        <div class="col-md-6">
          <span><a href="about.html">About</a></span>
          <span><a class="current" class="lead-btn" href="add.html">Add project</a></span>
          <span><a href="index.html">Home</a></span>
        </div>
      </nav>
      <section id="hero-intro" class="row">
        <h2>Submit a new project</h2>
      </section>
    </header>

    <main id="submit-form" class="row">
      <div id="submit-form-div" class="col-md-8 col-md-offset-2">
      <div class="well">Welcome to the Federal Inventory of Crowdsourcing and Citizen Science.  Below is a two-part webform for you to fill out entirely. If at any point you do not understand the field, please refer to <span class="glyphicon glyphicon-info-sign" data-toggle="tooltip" title="Hover over this for more instruction"></span> for more instructions.  The information collected will be displayed on a searchable map for the public to use.  To assist in visualizing the final product, explore the <a href="browse">map</a>. For further detail on each field of science category, please visit <a href="http://sites.nationalacademies.org/pga/Resdoc/PGA_044522.htm">this website</a>.</div>

      <form class="form-horizontal" method="post" action="">
        <fieldset>

          <legend class="orange"><i class="fa fa-file-text-o"></i>Project Information</legend>

          <!-- Text input-->
          <div class="form-group">
            <label class="col-md-4 control-label orange" for="project-name">Project Name <span data-toggle="tooltip" title="Commonly accepted name for the project" class="glyphicon glyphicon-info-sign"></span></label>
            <div class="col-md-6">
              <input id="project-name" name="project_name" type="text" placeholder="" class="form-control input-md" required="">

            </div>
          </div>

          <!-- Text input-->
          <div class="form-group">
            <label class="col-md-4 control-label orange" for="project-url">Project URL <span class="glyphicon glyphicon-info-sign" data-toggle="tooltip" title="URL for project website"></span></label>
            <div class="col-md-6">
              <input id="project-url" name="project_url" type="text" placeholder="http://" class="form-control input-md" required="">

            </div>
          </div>

          <!-- Textarea -->
          <div class="form-group">
            <label class="col-md-4 control-label orange" for="project-description">Project Description <span data-toggle="tooltip" title="1-3 sentences defining the mission statement for your project" class="glyphicon glyphicon-info-sign"></span></label>
            <div class="col-md-6">
              <textarea class="form-control" id="project-description" name="project_description"></textarea>
            </div>
          </div>

          <!-- Multiple Checkboxes -->
          <div class="form-group">
            <label class="col-md-4 control-label orange" for="field">Project topic <span data-toggle="tooltip" title="What federal agency (or agencies) offers either primary or partial fiscal support of this project?" class="glyphicon glyphicon-info-sign" class="glyphicon glyphicon-info-sign"></span></label>
            <div id="project_topic" class="col-md-4">
            </div>
          </div>

          <!-- Text input-->
          <div class="form-group">
            <label class="col-md-4 control-label orange" for="keywords">Project Keywords <span data-toggle="tooltip" title="Please enter descriptive keywords, separated by a comma, which will help someone find your project on the browsable map." class="glyphicon glyphicon-info-sign"></span></label>
            <div class="col-md-6">
              <input id="keywords" name="keywords" type="text" placeholder="" class="form-control input-md">

            </div>
          </div>

          <!-- Select Basic -->
          <div class="form-group">
            <label class="col-md-4 control-label orange" for="status">Project Status <span data-toggle="tooltip" title="What is the current status of this project?" class="glyphicon glyphicon-info-sign"></span></label>
            <div class="col-md-6">
              <select id="project_status" name="status" class="form-control">
              </select>
            </div>
          </div>

          <!-- Text input-->
          <div class="form-group">
            <label class="col-md-4 control-label orange" for="start-date">Project Start Date <span data-toggle="tooltip" title="Approximately when was the grant issued, or project launched?" class="glyphicon glyphicon-info-sign"></span></label>
            <div class="col-md-6">
              <input id="start-date" name="start_date" type="text" placeholder="yyyy-mm-dd" class="form-control input-md">

            </div>
          </div>

          <!-- Multiple Checkboxes -->
          <div class="form-group">
            <label class="col-md-4 control-label orange" for="sponsors">Agency Sponsor <span data-toggle="tooltip" title="What federal agency (or agencies) offers either primary or partial fiscal support of this project?" class="glyphicon glyphicon-info-sign" class="glyphicon glyphicon-info-sign"></span></label>
            <div id="agency_sponsor" class="col-md-4">
            </div>
          </div>

          <!-- Multiple Checkboxes -->
          <div class="form-group">
            <label class="col-md-4 control-label orange" for="partners">Agency Partner <span data-toggle="tooltip" title="A federal agency offering partial support" class="glyphicon glyphicon-info-sign"></span></label>
            <div id="agency_partner" class="col-md-6">
            </div>
          </div>

          <!-- Select Basic -->
          <div class="form-group">
            <label class="col-md-4 control-label orange" for="geographic-scope">Geographic Scope <span data-toggle="tooltip" title="Please select the best definition for your projects geographic scope." class="glyphicon glyphicon-info-sign"></span></label>
            <div class="col-md-6">
              <select id="geographic_scope" name="geographic_scope" class="form-control">
              </select>
            </div>
          </div>

          <!-- Multiple Checkboxes -->
          <div class="form-group">
            <label class="col-md-4 control-label orange" for="participant-age">Participant Age <span data-toggle="tooltip" title="Target age of participants" class="glyphicon glyphicon-info-sign"></span></label>
            <div id="participant_age" class="col-md-6">
            </div>
          </div>

          <!-- Multiple Checkboxes -->
          <div class="form-group">
            <label class="col-md-4 control-label orange" for="outcomes">Intended Outcomes <span data-toggle="tooltip" title="Desired outcomes of project" class="glyphicon glyphicon-info-sign"></span></label>
            <div id="intended_outcomes" class="col-md-6">
            </div>
          </div>

          <!-- Textarea -->
          <div class="form-group">
            <label class="col-md-4 control-label orange" for="participation-type">Participation Type <span data-toggle="tooltip" title="Description of volunteer activities" class="glyphicon glyphicon-info-sign"></span></label>
            <div class="col-md-6">
              <textarea class="form-control" id="participation-type" name="participation_type"></textarea>
            </div>
          </div>

        </fieldset>

        <fieldset>

          <legend class="blue"><i class="fa fa-map-marker"></i>Location Information</legend>

          <div class="well">
            <p>Please enter the address where the project is administered.  For example, if your project crowdsources identification of images, then where is the project and its dataset managed?  OR if your project conducts water quality monitoring across a tri-state water feature then where is that data collected and managed?</p>
            <p>After you enter an address and click the "Geocode Address" button, a pin will be placed on the map. To move the pin, click the edit button in the map and drag it to the most appropriate location. If you don't have an address, click the pin button on the left side of the map toolbar to draw the location.</p>
            <p>If the project you are entering is only funded by your agency and all other aspects of the project are conducted on site, then please enter the address location of the projects field/administration site. </p>
          </div>

          <div class="row">
            <div class="col-md-6" id="input-map">
              map
            </div>

            <div class="col-md-6" id="address">
              <!-- Text input-->
              <div class="form-group">
                <label class="col-md-4 control-label light-blue" for="street-address">Street Address <span data-toggle="tooltip" title="Physical contact address" class="glyphicon glyphicon-info-sign"></span></label>
                <div class="col-md-6">
                  <input id="street-address" name="street_address" type="text" placeholder="" class="form-control input-md">

                </div>
              </div>

              <!-- Text input-->
              <div class="form-group">
                <label class="col-md-4 control-label light-blue" for="street-address-2"></label>
                <div class="col-md-6">
                  <input id="street-address-2" name="street_address_2" type="text" placeholder="" class="form-control input-md">

                </div>
              </div>

              <!-- Text input-->
              <div class="form-group">
                <label class="col-md-4 control-label light-blue" for="city">City</label>
                <div class="col-md-6">
                  <input id="city" name="city" type="text" placeholder="" class="form-control input-md">

                </div>
              </div>

              <!-- Select Basic -->
              <div class="form-group">
                <label class="col-md-4 control-label light-blue" for="state">State</label>
                <div class="col-md-6">
                  <select id="state" name="state" class="form-control">
                    <option value="AL">AL</option>
                    <option value="AK">AK</option>
                    <option value="AZ">AZ</option>
                    <option value="AR">AR</option>
                    <option value="CA">CA</option>
                    <option value="CO">CO</option>
                    <option value="CT">CT</option>
                    <option value="DC">DC</option>
                    <option value="DE">DE</option>
                    <option value="FL">FL</option>
                    <option value="GA">GA</option>
                    <option value="HI">HI</option>
                    <option value="ID">ID</option>
                    <option value="IL">IL</option>
                    <option value="IN">IN</option>
                    <option value="IA">IA</option>
                    <option value="KS">KS</option>
                    <option value="KY">KY</option>
                    <option value="LA">LA</option>
                    <option value="ME">ME</option>
                    <option value="MD">MD</option>
                    <option value="MA">MA</option>
                    <option value="MI">MI</option>
                    <option value="MN">MN</option>
                    <option value="MS">MS</option>
                    <option value="MO">MO</option>
                    <option value="MT">MT</option>
                    <option value="NE">NE</option>
                    <option value="NV">NV</option>
                    <option value="NH">NH</option>
                    <option value="NJ">NJ</option>
                    <option value="NM">NM</option>
                    <option value="NY">NY</option>
                    <option value="NC">NC</option>
                    <option value="ND">ND</option>
                    <option value="OH">OH</option>
                    <option value="OK">OK</option>
                    <option value="OR">OR</option>
                    <option value="PA">PA</option>
                    <option value="RI">RI</option>
                    <option value="SC">SC</option>
                    <option value="SD">SD</option>
                    <option value="TN">TN</option>
                    <option value="TX">TX</option>
                    <option value="UT">UT</option>
                    <option value="VT">VT</option>
                    <option value="VA">VA</option>
                    <option value="WA">WA</option>
                    <option value="WV">WV</option>
                    <option value="WI">WI</option>
                    <option value="WY">WY</option>
                    <option value="GU">GU</option>
                    <option value="PR">PR</option>
                    <option value="VI">VI</option>
                  </select>
                </div>
              </div>

              <!-- Text input-->
              <div class="form-group">
                <label class="col-md-4 control-label light-blue" for="zip">Zip Code</label>
                <div class="col-md-6">
                  <input id="zip" name="zip" type="text" placeholder="" class="form-control input-md">

                </div>
              </div>

              <div class="form-group">
                <div class="col-md-4 col-md-offset-4">
                  <button type="button" id="geocode" name="geocode" class="btn btn-primary">Geocode Address</button>
                </div>
              </div>

            </div>

          </div>

          <input type="hidden" name="the_geom" id="latlng" value="">
        </fieldset>

        <fieldset>

          <legend class="light-blue"><i class="fa fa-phone"></i>Contact Information</legend>

          <!-- Text input-->
          <div class="form-group">
            <label class="col-md-4 control-label light-blue" for="project-contact">Project Contact <span data-toggle="tooltip" title="Name of project contact" class="glyphicon glyphicon-info-sign"></span></label>
            <div class="col-md-6">
              <input id="project-contact" name="project_contact" type="text" placeholder="" class="form-control input-md" required="">

            </div>
          </div>

          <!-- Text input-->
          <div class="form-group">
            <label class="col-md-4 control-label light-blue" for="affiliation">Contact Affiliation <span data-toggle="tooltip" title="Affiliation of project contact" class="glyphicon glyphicon-info-sign"></span></label>
            <div class="col-md-6">
              <input id="affiliation" name="affiliation" type="text" placeholder="" class="form-control input-md">

            </div>
          </div>

          <!-- Text input-->
          <div class="form-group">
            <label class="col-md-4 control-label light-blue" for="email">Contact Email <span data-toggle="tooltip" title="Contact email address" class="glyphicon glyphicon-info-sign"></span></label>
            <div class="col-md-6">
              <input id="email" name="email" type="text" placeholder="" class="form-control input-md">

            </div>
          </div>

          <!-- Text input-->
          <div class="form-group">
            <label class="col-md-4 control-label light-blue" for="phone">Contact Phone <span data-toggle="tooltip" title="Contact phone number" class="glyphicon glyphicon-info-sign"></span></label>
            <div class="col-md-6">
              <input id="phone" name="phone" type="text" placeholder="123-456-7890" class="form-control input-md">

            </div>
          </div>

          <div class="panel panel-info">
            <div class="panel-heading">
              <h3 class="panel-title text-center">That's everything!</h3>
            </div>
          </div>

          <!-- Button -->
          <div class="form-group">
            <div class="col-md-4 col-md-offset-4">
              <button id="submit" name="submit" class="btn btn-primary">Submit Entire Form</button>
            </div>
          </div>

        </fieldset>

      </form>
      </div>
    </main>

    <footer>
      <div class="row footer-nav">
        <div class="col-md-offset-2 col-md-2">
          <ul class="list-unstyled">
            <li><a href="index.html">Home</a></li>
            <li><a href="add.html">Add project</a></li>
            <li><a href="about.html">About</a></li>
            <li><a href="data-policy.html">Data policy</a></li>
            <li><a href="http://www.wilsoncenter.org/privacy-policy">Privacy policy</a></li>
          </ul>
        </div>
        <div class="initiative-by col-md-offset-1 col-md-7">
          <p>An initiative led by:</p>
          <image xlink:href="img/commons_logo.svg" src="img/commons_logo.png"
                 width="260" height="40" />
          <image xlink:href="img/wilson_logo.svg" src="img/wilson_logo.png"
                 width="260" height="40" />
        </div>
      </div>

      <div class="row copyright">
        <div class="col-md-12 text-center"><p>Copyrighted by <a href="http://wilsoncenter.org/the-commons-lab-inventory">Wilson Center</a> &#169; 2015 · Developed by <a href="http://icarto.es" target="_blank">iCarto</a></p></div>
      </div>

    </footer>

    <!-- templates -->
    <script type="text/template" id="filter-checkbox-tmpl">
      <div class="checkbox inline">
        <label for="<%- property_code %>">
          <input type="checkbox" id="<%- property_code %>" name="<%- property_category %>" value="<%- property_name %>" />
          <%- property_name %>
        </label>
      </div>
    </script>

    <!-- templates -->
    <script type="text/template" id="filter-select-tmpl">
      <option value="<%- property_name %>"><%- property_name %></option>
    </script>

    <script type="text/template" id="success-tmpl">
	<h2 class="light-blue text-center" id="thanks">Thank you for submitting a project!</h2>
    </br>

	<div class="well col-md-8 col-md-offset-2">
		<p>Our project submission process allows the Commons Lab to collect and maintain accurate and up-to-date information, while also respecting the potential sensitivity of the information shared. </p>
		<p>To support verification, a Commons Lab employee will contact a project coordinator within 3-5 days of receiving the form. The Commons Lab will collaborate with the project coordinator to finalize the database record, and discuss how potentially sensitive information will be presented. When verification is complete, the project will be published through the Commons Lab inventory and accessible through the mapped interface.</p>

		<p>If you have questions about the Commons Lab Inventory or the process of submitting a project, please contact Elizabeth Tyson at: </p>
		<p><a href="mailto:Elizabeth.tyson@wilsoncenter.org">Elizabeth.tyson@wilsoncenter.org</a> or 202-691-4319. </p>
	</div>
    </script>

    <script src="js/vendor/jquery-min-1.11.3.js"></script>
    <script src="js/vendor/bootstrap.min.js"></script>
    <script src="js/vendor/bootstrap-datepicker.js"></script>
    <script src="js/vendor/cartodb.js"></script>
    <script src="js/vendor/json2.js"></script>
    <script src="js/vendor/underscore-min-1.8.2.js"></script>
    <script src="js/vendor/backbone-min-1.2.1.js"></script>
    <script src="js/vendor/leaflet-0.7.3.js"></script>
    <script src="js/vendor/leaflet.draw.js"></script>
    <script src="js/vendor/tile.stamen.1.3.0.js"></script>
    <!-- our own -->
    <script src="js/config.js"></script>
    <script src="js/CCSI.js"></script>
    <script src="js/models/Property.js"></script>
    <script src="js/models/Project.js"></script>
    <script src="js/collections/Properties.js"></script>
    <script src="js/views/PropertyComponent.js"></script>
    <script src="js/views/ProjectForm.js"></script>
    <script src="js/add.js"></script>

    <script>
      var map;
      var drawnItems;

      $( document ).ready(function() {
      $('#date-updated').datepicker({
      format: 'yyyy-mm-dd'
      });
      $('#start-date').datepicker({
      format: 'yyyy-mm-dd'
      });
      initMap();
      $("[data-toggle='tooltip']").tooltip();

      });

      function initMap() {

      map = L.map('input-map', { scrollWheelZoom: false }).setView([36, -91], 3);

      var baseMap = new L.StamenTileLayer("toner-lite");
      map.addLayer(baseMap);

      // Initialise the FeatureGroup to store editable layers
      drawnItems = new L.FeatureGroup();
      map.addLayer(drawnItems);

      // Initialise the draw control and pass it the FeatureGroup of editable layers
      var drawControl = new L.Control.Draw({
      draw: {
      position: 'topleft',
      polygon: false,
      polyline: false,
      circle: false,
      rectangle: false
      },
      edit: {
      featureGroup: drawnItems
      }
      });
      map.addControl(drawControl);

      map.on('draw:created', function (e) {
      drawnItems.clearLayers();
      var type = e.layerType,
      layer = e.layer;

      if (type === 'marker') {
      layer.bindPopup('Project home location');
      }

      drawnItems.addLayer(layer);

      $("#latlng").val('ST_SetSRID(ST_Point(' + layer.getLatLng().lng + ',' + layer.getLatLng().lat + '),4326)');
      });

      }

      // add location button event
      $("#geocode").click(function(e){

      e.preventDefault();

      // the name form field value
      var street = $("#street-address").val();
      var city = $("#city").val();
      var state = $("#state").val();
      var zip = $("#zip").val();

      if(!street || !city) {
      alert('Street address and city are required');
      return;
      }

      $.ajax({
      type: "GET",
      dataType: "jsonp",
      contentType: "application/json",
      url: 'http://geocoding.geo.census.gov/geocoder/locations/address?street=' + street + '&city=' + city + '&state=' + state+ '&zip=' + zip + '&benchmark=9&format=jsonp',
      success: function(data) {
      if(data.result.addressMatches[0]) {
      var gcLat = data.result.addressMatches[0].coordinates.y;
      var gcLon = data.result.addressMatches[0].coordinates.x;
      var gcLoc = new L.latLng(gcLat, gcLon);
      map.setView(gcLoc, 12);
      drawnItems.clearLayers();
      L.marker(gcLoc).addTo(drawnItems);
      $("#latlng").val('ST_SetSRID(ST_Point(' + gcLoc.lng + ',' + gcLoc.lat + '),4326)');
      }
      else alert('There was a problem geocoding that address. Please check that the address is valid.');
      },
      error: function(xhr, ajaxOptions, thrownError) {
      alert(xhr.status, thrownError);
      }
      });
      return false;

      });

    $(function () {
        $('.button-checkbox').each(function () {

            // Settings
            var $widget = $(this),
                $button = $widget.find('button'),
                $checkbox = $widget.find('input:checkbox'),
                color = $button.data('color'),
                settings = {
                    on: {
                        icon: 'glyphicon glyphicon-check'
                    },
                    off: {
                        icon: 'glyphicon glyphicon-unchecked'
                    }
                };

            // Event Handlers
            $button.on('click', function () {
                $checkbox.prop('checked', !$checkbox.is(':checked'));
                $checkbox.triggerHandler('change');
                updateDisplay();
            });
            $checkbox.on('change', function () {
                updateDisplay();
            });

            // Actions
            function updateDisplay() {
                var isChecked = $checkbox.is(':checked');

                // Set the button's state
                $button.data('state', (isChecked) ? "on" : "off");

                // Set the button's icon
                $button.find('.state-icon')
                    .removeClass()
                    .addClass('state-icon ' + settings[$button.data('state')].icon);

                // Update the button's color
                if (isChecked) {
                    $button
                        .removeClass('btn-default')
                        .addClass('btn-' + color + ' active');
                }
                else {
                    $button
                        .removeClass('btn-' + color + ' active')
                        .addClass('btn-default');
                }
            }

            // Initialization
            function init() {

                updateDisplay();

                // Inject the icon if applicable
                if ($button.find('.state-icon').length == 0) {
                    $button.prepend('<i class="state-icon ' + settings[$button.data('state')].icon + '"></i> ');
                }
            }
            init();
        });
    });

    </script>

  </body>
</html>
